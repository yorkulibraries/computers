<% if @image.errors.size == 0 %>
  $("#image_form").modal( 'hide' ).data( 'bs.modal', null );
  $( '.modal-backdrop' ).remove();

  // update via  partial and insert it into proper place
  if ($("#images").is("table")) {
    $("#image_<%= @image.id %>").replaceWith("<%= j render partial: "images/image", formats: [:html], locals: { image: @image, show: "tr" } %>");
  } else {
    $("#image_<%= @image.id %>").replaceWith("<%= j render partial: "images/image", formats: [:html], locals: { image: @image, show: "div"} %>");
  }

  $("#image_<%= @image.id %>").effect("highlight", {}, 3000);

<% else %>
  $( '.modal-backdrop' ).remove();
  $("#image_form").modal('hide');
  $("#image_form").replaceWith("<%= j render "form", formats: [:html] %>");
  $("#image_form").modal("show");
<% end %>
